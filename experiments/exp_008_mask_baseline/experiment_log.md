# 実験結果まとめ - Mask-Based Baseline

> 最終更新: 2026-01-10

## 実験履歴

| # | 日時 | 変更点 | SSIM(mask) | PSNR(mask) | CV Score | PB Score | 所見 |
|---|------|--------|------------|------------|----------|----------|------|
| 0 | 01/09 | 旧コード (フル画像Loss, ep3) | 0.87* | 15.3* | - | **0.354** | *フル画像評価 |
| 1 | 01/09 | マスクLoss導入, ep15 | 0.66 | 14.4 | 0.33 | **0.417** | +0.06 改善 |
| 2 | 01/10 | ep30 | 0.68 | 14.6 | 0.35 | **0.418** | 収束確認、頭打ち |
| 3 | 01/10 | MSE 0.02→0.1 | 0.66 | 14.5 | 0.33 | **0.417** | 効果なし |
| 4 | 01/10 | デバッグ追加 | 0.66 | 14.4 | 0.33 | - | 出力が0.07-0.10に潰れていた！ |
| 5 | 01/10 | **sigmoid追加** | 0.66 | 14.6 | 0.33 | - | 学習開始(12.5→14.6)、まだ頭打ち |

---

## 重大発見 (実験4)

**デバッグ出力で判明:**
```
outputs: min=0.0748, max=0.0990, mean=0.0907
sample_pred.png:  min=19, max=25   ← ほぼ灰色一色
```

→ **SimpleUNetの出力層にsigmoidがなく、出力が潰れていた**

---

## sigmoid追加後の学習推移 (実験5)

| Epoch | PSNR | SSIM | 備考 |
|-------|------|------|------|
| 1 | 12.5 | 0.47 | 初期(sigmoid効果で0.5付近からスタート) |
| 5 | 14.2 | 0.65 | 上昇 |
| 11 | **14.6** | 0.66 | ピーク |
| 15 | 14.5 | 0.66 | 横ばい |

**進歩:** 学習が機能するようになった（12.5→14.6）
**問題:** まだ14.5dBで頭打ち

---

## 次の仮説

1. **SimpleUNetの容量不足** - SMPが使われているか要確認
2. **Learning rate** - 1e-4 → 3e-4 で加速
3. **epoch不足** - 30epochで再確認

---

## 学んだ教訓

1. **評価指標の一致が最重要** - ローカルCVとコンペ評価が異なると全て無駄になる
2. **デバッグ出力を最初から入れるべき** - value rangeの確認は必須
3. **単一変数で実験** - 複数同時に変えると原因特定不可
